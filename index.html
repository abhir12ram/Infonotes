<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Q & Answers</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
* { box-sizing: border-box; }      
body { font-family: 'Poppins', Arial, sans-serif; background: #f9f9f9; color: #111; margin: 0; padding: 0; }
header { background: #ffffff; text-align: center; padding: 15px; font-weight: 600; position: sticky; top:0; z-index:10; }
.container { padding: 15px; max-width: 600px; margin: auto; }
input, textarea { width: 100%; margin: 8px 0; padding: 12px; border: 1px solid #ccc; border-radius: 10px; background: #fff; }
button { border: none; border-radius: 10px; padding: 10px 15px; margin: 6px 4px; font-size: 15px; cursor: pointer; }
button.save { background: #28a745; color: #fff; }

.note {
  background: #fff;
  padding: 12px;
  margin-top: 12px;
  border-radius: 10px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.preview-text {
  display: -webkit-box;
  -webkit-line-clamp: 2; 
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  max-height: 3.2em;
}

.note-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 10px;
}
.note-buttons button { width: 32%; }
button.view { background: #007bff; color: #fff; }
button.delete { background: #dc3545; color: #fff; }

/* VIEW PAGE */
#viewPage {
  padding: 20px;
  max-width: 650px;
  margin: auto;
  background: #ffffff;
}
#viewPage .back {
  background: #f1f1f1;
  color: #333;
  border-radius: 10px;
  padding: 10px 18px;
  margin-bottom: 20px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 16px;
}
#viewTitle {
  text-align: center;
  font-size: 26px;
  font-weight: 700;
  color: #222;
  margin-bottom: 10px;
}
#viewInfo {
  background: #eef5ff;
  color: #2a4a7b;
  padding: 10px 15px;
  border-radius: 10px;
  font-size: 15px;
  text-align: center;
  margin-bottom: 10px;
  display: inline-block;
}
#viewDate {
  background: #fff7e6;
  color: #8a6d3b;
  padding: 8px 15px;
  border-radius: 8px;
  font-size: 14px;
  margin-bottom: 20px;
  display: inline-block;
}
#viewContent {
  font-size: 18px;
  line-height: 1.6;
  color: #333;
  padding: 20px;
  background: #fafafa;
  border-radius: 12px;
  white-space: pre-wrap;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

</head>
<body>

<header>üìù My Notepad (Cloud Sync)</header>

<div class="container" id="homePage">
  <input type="text" id="title" placeholder="Title">
  <input type="text" id="info" placeholder="Information (optional)">
  <textarea id="content" placeholder="Write your note..."></textarea>
  <button class="save" onclick="saveNote()">Save</button>
  <div id="notesList"></div>
</div>

<div id="viewPage" style="display:none;">
  <button class="back" onclick="goBack()">‚¨Ö Back</button>
  <h2 id="viewTitle"></h2>
  <div id="viewInfo"></div>
  <div id="viewDate"></div>
  <p id="viewContent"></p>
</div>

<script>
/* -----------------------------------------
     CONFIG
------------------------------------------ */
const API = "https://sheetdb.io/api/v1/geyyaf2q2gasg";

/* -----------------------------------------
    LOAD NOTES (GET)
------------------------------------------ */
async function loadNotes() {
  const res = await fetch(API);
  const notes = await res.json();
  renderNotes(notes);
}

/* Render notes list */
function renderNotes(notes) {
  const list = document.getElementById("notesList");
  list.innerHTML = "";

  if (notes.length === 0) {
    list.innerHTML = `<p style="text-align:center;color:#888;">No notes yet</p>`;
    return;
  }

  notes.reverse().forEach(note => {
    const div = document.createElement("div");
    div.className = "note";

    div.innerHTML = `
      <div class="note-title">${note.title}</div>
      ${note.info ? `<div class="note-extra">‚ÑπÔ∏è ${note.info}</div>` : ""}
      <div class="note-info">üïí ${note.date}</div>
      <div class="note-content">${note.content}</div>
      <div style="margin-top:6px;">
        <button class="view" onclick="viewNote('${note.id}')">View</button>
        <button class="edit" onclick="editNote('${note.id}')">Edit</button>
        <button class="delete" onclick="deleteNote('${note.id}')">Delete</button>
      </div>
    `;
    list.appendChild(div);
  });
}

/* -----------------------------------------
    SAVE NOTE (POST or PUT)
------------------------------------------ */
async function saveNote() {
  const title = document.getElementById("title").value.trim();
  const info = document.getElementById("info").value.trim();
  const content = document.getElementById("content").value.trim();
  const editId = document.getElementById("title").getAttribute("data-edit-id");

  if (!title || !content) {
    alert("Please enter Title & Note!");
    return;
  }

  const data = {
    id: editId ? editId : Date.now().toString(),
    title,
    info,
    content,
    date: new Date().toLocaleString(),
  };

  /* UPDATE NOTE (PUT) */
  if (editId) {
    await fetch(`${API}/id/${editId}`, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ data })
    });

    document.getElementById("title").removeAttribute("data-edit-id");
  } else {
    /* CREATE NOTE (POST) */
    await fetch(API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ data })
    });
  }

  document.getElementById("title").value = "";
  document.getElementById("info").value = "";
  document.getElementById("content").value = "";

  loadNotes();
}

/* -----------------------------------------
      VIEW NOTE
------------------------------------------ */
async function viewNote(id) {
  const res = await fetch(`${API}/search?id=${id}`);
  const [note] = await res.json();

  document.getElementById("viewTitle").innerText = note.title;
  document.getElementById("viewInfo").innerText = note.info ? "‚ÑπÔ∏è " + note.info : "";
  document.getElementById("viewDate").innerText = "üïí " + note.date;
  document.getElementById("viewContent").innerText = note.content;

  document.getElementById("homePage").style.display = "none";
  document.getElementById("viewPage").style.display = "block";
}

/* -----------------------------------------
      EDIT NOTE
------------------------------------------ */
async function editNote(id) {
  const res = await fetch(`${API}/search?id=${id}`);
  const [note] = await res.json();

  document.getElementById("title").value = note.title;
  document.getElementById("info").value = note.info;
  document.getElementById("content").value = note.content;

  document.getElementById("title").setAttribute("data-edit-id", id);

  document.getElementById("homePage").scrollIntoView();
}

/* -----------------------------------------
      DELETE NOTE
------------------------------------------ */
async function deleteNote(id) {
  if (!confirm("Delete this note?")) return;

  await fetch(`${API}/id/${id}`, { method: "DELETE" });
  loadNotes();
}

/* -----------------------------------------
      BACK BUTTON
------------------------------------------ */
function goBack() {
  document.getElementById("viewPage").style.display = "none";
  document.getElementById("homePage").style.display = "block";
}

/* -----------------------------------------
      INITIAL LOAD
------------------------------------------ */
loadNotes();
</script>

</body>
</html>
